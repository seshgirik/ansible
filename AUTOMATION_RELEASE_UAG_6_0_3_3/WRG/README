Instructions to configure and run VNF playbook: 
------------------------------------------------

**  Tested with ansible verion 2.1 and python version 2.7 
**  libguestfs-tools-c-1.28.1-1.55.el7.x86_64 rpm should be installed


Playbook Configuration:
----------------------

1. Configure the openstack host in the following file:
	<installation_path>/inventory.ini

   The entry should be as below, change only the IP Address as required.
	[openstack_client_host]
	10.10.72.130
   This is typically installed with openstack clients from where heat stack commands will be executed. It can be openstack controller, director or a VM with openstack clients installed (and has connectivity with server)

2. Ensure passwordless ssh connection to the "openstack_client_host"

3. The role "common" is required for all other roles and must be included

4. Configure parameters in following file:

	roles/common/vars/main.yaml
        roles/common/vars/stack_operation.yaml
	Parameters:
	{VNF}_stack: true/false  => if {VNF}_stack is true, the stack will be included otherwise it is skipped 

5. Place the credentials of openstack target host in following directory with file name  "credentialsrc"
   Place the admin credentials of openstack target host in following directory with file name  "admin_credentialsrc"
   The admin credentials will be used for provider network creation within base-admin role.

         roles/common/files

   The "credentialsrc" or "admin_credentialsrc" should contain following, with values replaced appropriately:
	export OS_USERNAME=username
	export OS_PASSWORD=real_password
	export OS_AUTH_URL=http://10.10.72.130:5000/v2.0
	export OS_TENANT_NAME=tenant_name
	export OS_REGION_NAME=RegionOne

6. The VNF qcow2 images should be placed in following path:

         roles/common/files/qcow2_images


7. There is single common environment file for all the VNFs. This file is in below location, which should be configured for image filename, Network IPs, flavors and other VNF paramaters. The heat template environment files will get updated with these values.

         roles/common/vars/environment_file.yaml

   The IPs for base and fabric internal networks should be configured as per Mavenir Named file/IP configuration. The subnets other than the "Mavenir Zone IP configuration" is not supported.

   If internal/external networks are created as part of the ansible, no need to configure the UUIDs in the environment_file.yaml.
   The internal networks (base, fabric and instantce_management networks) can be tenant or provider networks. The templates are provided for both implementations. Copy the required templates before execution.
         cp base_WRG_CPlane_Internal_Network.yaml.tenant base_WRG_CPlane_Internal_Network.yaml
         cp base_WRG_CPlane_Internal_Network.env.tenant base_WRG_CPlane_Internal_Network.env
      or
         base_WRG_CPlane_Internal_Network.yaml.provider base_WRG_CPlane_Internal_Network.yaml 
         base_WRG_CPlane_Internal_Network.env.provider base_WRG_CPlane_Internal_Network.env

8. The network UUIDs and Security group UUIDs will be updated in the common environment file during runtime, once the corresponding stacks are created

9. The qcow2 image can be patched with sql file and post install script. The sql file will be sourced during VM instantiation and post install script willbe executed. The files need to be copied to following location with following names. The patching is done for the ADM qcow2 image file only.
         roles/common/files/WRG_CPlane_AM_db.sql
         roles/common/files/WRG_CPlane_post_install.sh


10. To start play, execute following command:

            To create VNFs:
                ansible-playbook -vv vnf_create.yaml -i inventory.ini

            To delete VNFs:
                ansible-playbook -vv vnf_delete.yaml -i inventory.ini

